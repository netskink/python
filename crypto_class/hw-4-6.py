The rest was walls of text. Pity I don't have this code anymore.
